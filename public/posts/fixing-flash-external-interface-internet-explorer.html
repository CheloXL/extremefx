<!DOCTYPE html>
<html>
    <head>
        <title>Fixing Flash External Interface inside Forms on Internet Explorer</title>
    </head>
    <body>
            <a href="/"><h1>Marcelo Volmaro on Programming, User Experience and anything else.</h1> </a>
        
                <li><a href="/posts">Archive</a></li>
                <li><a href="/tags">Tags</a></li>
                <li><a href="/about">About Me</a></li>
                <li><a href="/contact">Contact</a></li>

        
<h2>Fixing Flash External Interface inside Forms on Internet Explorer</h2>
<h3>Published 23/2/2007</h3>


        <a href="/tags/Flash,-Javascript">Flash, Javascript</a> 

<a href="/posts">Back To posts</a>

<p>As you all may know (or may not), if you want to use External Interface on a flash object that lives inside an &quot;HTML&quot; form, it will not work.</p>
<p>I will show you a simple test:</p>
<pre><code class="language-html">&lt;form&gt;
	&lt;object id=&quot;flashElement1&quot; width=&quot;256&quot; height=&quot;64&quot; data=&quot;files/bug4.swf&quot; type=&quot;application/x-shockwave-flash&quot;&gt;
		&lt;param name=&quot;movie&quot; value=&quot;files/bug4.swf&quot; /&gt;
		&lt;param name=&quot;allowScriptAccess&quot; value=&quot;always&quot; /&gt;
	&lt;/object&gt;
	&lt;p&gt;&lt;a onclick=&quot;document.getElementById('flashElement1').testFunction(); return false;&quot; href=&quot;#&quot;&gt;Click to test&lt;/a&gt;&lt;/p&gt;
&lt;/form&gt;
</code></pre>
<p>First of all, you will get a javascript error saying that the element “flashElement1” is undefined. And while in the flash window you will see the “CallBack added Ok”, if you click on the “Click to test” link you will get another error saying that the Object doesn't support that property or method.</p>
<p><strong>Why?:</strong> Easy. The way the javascript bridge with flash was coded is really awful. In IE, every time you add an “ID” attribute to an &quot;HTML&quot; element, that element is added to the “window”
element so you can access it directly using window.elementID... but if you place the element inside an &quot;HTML&quot; form, the element is added to the form element (document.forms[0].elementID if you have only one form) and not window element. I suppose the person who did the bridge knowns nothing about this... I will not get into the details here, but you can believe me: The bridge it's screaming for a rewriting.</p>
<p><strong>How?:</strong> Well, this will depend on how are you embedding the object on the &quot;HTML&quot; page. If you use <a href="http://blog.deconcept.com/swfobject/">SwfObject</a> you should add the following line after the
line 105 (the line that reads <code>n.innerHTML = this.getSWFHTML();</code>):</p>
<pre><code class="language-javascript">if(!(navigator.plugins &amp;amp;&amp;amp; navigator.mimeTypes.length))
    window[this.getAttribute('id')] = document.getElementById(this.getAttribute('id'));
</code></pre>
<p>That applies to the current version of SwfObject (1.4.4).</p>
<p>If you use <a href="http://www.bobbyvandersluis.com/ufo/">UFO</a> you should add the following line after the line 230 (the line that reads <code>_e.innerHTML = '&lt;object classid=&quot;...</code>):</p>
<pre><code class="language-javascript">if (_fo[&quot;id&quot;]) window[_fo[&quot;id&quot;]] = document.getElementById(_fo[&quot;id&quot;]);
</code></pre>
<p>That applies to &quot;UFO&quot; 3.20.</p>
<p>And if you use <a href="http://www.adobe.com/devnet/activecontent/articles/devletter.html">Adobe's Active Content</a> you should add the following line after the line 24 (the line that reads <code>document.write(str);</code>):</p>
<pre><code class="language-javascript">if (objAttrs[&quot;id&quot;]) window[objAttrs[&quot;id&quot;]] = document.getElementById(objAttrs[&quot;id&quot;]);
</code></pre>




    </body>
</html>

